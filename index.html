<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FOMO SOCIAL</title>

<!-- Favicon -->
<link rel="icon" type="image/png" href="https://raw.githubusercontent.com/shitcoinheiros/fomosocial/refs/heads/main/fomo%20social%20logo.png">

<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#FF69B4">

<!-- ðŸ”¥ Anti-cache -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<!-- Libs -->
<script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

<style>
body { background: #0d0f0f; color: #ADD8E6; font-family: 'Orbitron', sans-serif; }
.neon { text-shadow: 0 0 5px #FF69B4, 0 0 10px #FF69B4, 0 0 20px #FF69B4; }
.btn-neon {
  background-color: #FF69B4 !important;
  color: black !important;
  box-shadow: 0 0 10px #FF69B4, 0 0 20px #FF69B4, 0 0 40px #FF69B4;
  transition: all 0.3s ease-in-out;
}
.btn-dashboard {
  background-color: #111;
  border: 2px solid #ADD8E6;
  color: #ADD8E6;
  font-weight: bold;
  padding: 15px 20px;
  border-radius: 12px;
  cursor: pointer;
  text-align: center;
  transition: all 0.2s ease-in-out;
}
.btn-dashboard:disabled { opacity: 0.5; cursor: not-allowed; }
.btn-dashboard:hover:enabled {
  background-color: #ADD8E6;
  color: black;
  box-shadow: 0 0 10px #ADD8E6, 0 0 20px #ADD8E6;
}
/* Modal para tela de spam */
#spamModal {
  position: fixed; inset: 0; background: rgba(0,0,0,0.85);
  display: none; justify-content: center; align-items: center; z-index: 50;
}
#spamModalContent {
  background: #111; width: 90%; max-width: 4xl; height: 80%;
  border-radius: 1rem; position: relative; overflow: hidden;
}
#spamModalClose {
  position: absolute; top: 1px; right: 1px;
  background: #FF2E2E; color: white; border: none;
  padding: 5px 10px; border-radius: 8px; cursor: pointer; z-index: 10;
}
#spamIframeContainer { width: 100%; height: 100%; }
</style>
</head>
<body class="flex flex-col items-center min-h-screen p-6">

<header class="w-full flex justify-between items-center py-4 px-6 border-b border-pink-500/30">
  <h1 class="text-3xl font-bold neon">FOMO SOCIAL</h1>
  <button id="connectBtn" class="bg-pink-500 hover:bg-pink-600 text-black font-bold py-2 px-4 rounded-lg shadow-lg transition">
    Conectar
  </button>
</header>

<!-- Modal de spam -->
<div id="spamModal">
  <div id="spamModalContent">
    <button id="spamModalClose">X</button>
    <div id="spamIframeContainer"></div>
  </div>
</div>

<!-- Dashboard -->
<main id="dashboard" class="hidden mt-10 w-full max-w-3xl">
  <div class="bg-[#111] border border-pink-500/30 rounded-2xl p-6 shadow-xl flex flex-col gap-4">
    <h2 class="text-2xl font-bold mb-4 neon text-center">Dashboard</h2>
    <p class="mb-4 text-center">Carteira conectada: <span id="walletAddress" class="font-mono text-cyan-400 break-all"></span></p>
    <p id="tokenWarning" class="text-red-500 font-bold text-center mb-4 hidden">
      VocÃª nÃ£o possui token de acesso!
    </p>
    <div class="grid grid-cols-2 sm:grid-cols-3 gap-4">
      <button class="btn-dashboard flex items-center justify-center gap-2" id="btn1" disabled
        onclick="window.open('https://chat.whatsapp.com/KtQeB6Ua9jI0wWEBqrPDyL?mode=ac_t','_blank')">
        <i class="fab fa-whatsapp"></i> VIP
      </button>
      <button class="btn-dashboard" id="btn2" disabled><i class="fa-solid fa-rocket"></i> Trend</button>
      <button class="btn-dashboard" id="btn3" disabled onclick="alert('Moeda secreta em construÃ§Ã£o!')"><i class="fa-solid fa-bitcoin-sign"></i> Secret</button>
      <button class="btn-dashboard" id="btn4" disabled onclick="alert('RelatÃ³rio em construÃ§Ã£o!')"><i class="fa-solid fa-paperclip"></i> Report</button>
      <button class="btn-dashboard" id="btn5" disabled onclick="alert('Airdrop em construÃ§Ã£o!')"><i class="fa-solid fa-parachute-box"></i> Airdrop</button>
      <button class="btn-dashboard" id="btn6" disabled onclick="alert('Trade em construÃ§Ã£o!')"><i class="fa-solid fa-money-bill-trend-up"></i> Trade</button>
    </div>
  </div>
</main>

<script>
let web3, accounts;
const TARGET_CHAIN_ID = '0x61';
const TOKEN_ADDRESS = "0x3C6581Ae982CA058CB726B6C1Bc14917FB4F0672";
const TOKEN_ABI = [{"constant": true,"inputs": [{"name": "_owner","type": "address"}],"name": "balanceOf","outputs": [{"name": "balance","type": "uint256"}],"type": "function"}];

async function switchToBSC() {
  try {
    await window.ethereum.request({ method: 'wallet_switchEthereumChain', params:[{chainId: TARGET_CHAIN_ID}] });
    return true;
  } catch(err) {
    if(err.code===4902) {
      try {
        await window.ethereum.request({method:'wallet_addEthereumChain',params:[{
          chainId: TARGET_CHAIN_ID,
          chainName: 'BSC Testnet',
          nativeCurrency:{name:'BNB', symbol:'BNB', decimals:18},
          rpcUrls:['https://data-seed-prebsc-1-s1.binance.org:8545/'],
          blockExplorerUrls:['https://testnet.bscscan.com/']
        }]});
        return true;
      } catch(addErr){ console.error(addErr); return false; }
    }
    console.error(err); return false;
  }
}

async function checkTokenBalance(address) {
  try {
    const contract = new web3.eth.Contract(TOKEN_ABI, TOKEN_ADDRESS);
    const balance = await contract.methods.balanceOf(address).call();
    return web3.utils.fromWei(balance, 'ether');
  } catch (err) {
    console.error("Erro ao verificar o saldo do token:", err);
    return 0;
  }
}

async function connectWallet() {
  if(!window.ethereum || !window.ethereum.isMetaMask) return alert('Instale a MetaMask');
  try {
    web3 = new Web3(window.ethereum);
    accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
    const switched = await switchToBSC();
    if(!switched) return;
    await postConnect();
  } catch(e){ alert('ConexÃ£o rejeitada'); }
}

async function postConnect() {
  const wallet = accounts?.[0]; if (!wallet) return;
  document.getElementById('walletAddress').innerText = wallet;
  document.getElementById('dashboard').classList.remove('hidden');
  document.getElementById('connectBtn').innerText='Conectado';
  document.getElementById('connectBtn').classList.add('btn-neon');
  document.getElementById('connectBtn').disabled=true;
  const balance = await checkTokenBalance(wallet);
  if(balance > 0) {
    document.querySelectorAll('.btn-dashboard').forEach(b => b.disabled = false);
    document.getElementById('tokenWarning').style.display = 'none';
  } else {
    document.querySelectorAll('.btn-dashboard').forEach(b => b.disabled = true);
    document.getElementById('tokenWarning').style.display = 'block';
  }
}

document.getElementById('connectBtn').addEventListener('click', connectWallet);

/* BotÃ£o AÃ§Ã£o 2 abre modal e carrega iframe dinamicamente */
const btn2 = document.getElementById('btn2');
const spamModal = document.getElementById('spamModal');
const spamIframeContainer = document.getElementById('spamIframeContainer');
const spamModalClose = document.getElementById('spamModalClose');

btn2.addEventListener('click', ()=>{
  spamIframeContainer.innerHTML = '';
  const iframe = document.createElement('iframe');
  iframe.src = 'trend.html';
  iframe.style.width = '100%';
  iframe.style.height = '100%';
  iframe.style.border = 'none';
  spamIframeContainer.appendChild(iframe);
  spamModal.style.display = 'flex';
});
spamModalClose.addEventListener('click', ()=>{
  spamIframeContainer.innerHTML = '';
  spamModal.style.display = 'none';
});
</script>

<footer class="w-full mt-6 text-center text-gray-400 text-xs"></footer>

<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("/sw.js")
    .then(() => console.log("Service Worker registrado!"))
    .catch((err) => console.error("Erro ao registrar o Service Worker:", err));
}
</script>
</body>
</html>
